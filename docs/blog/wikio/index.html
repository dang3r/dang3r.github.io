<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="generator" content="Hugo 0.32.2" />
		<title>Wikireducer : Following Wikipedia links - Daniel Cardoza</title>

		<meta name="description" content="Wikireducer, Wikio">


		

		<link  rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono|Lato|Raleway">

		

		
		<link rel="stylesheet" href="/css/ui.min.css"/>
		
		<style>
	a { color: #ff8181; }
	blockquote {
		border-left-color: #ff8181;
		border-right-color: #ff8181; }
	.bar a:hover {
		color: #ff8181;
		text-decoration: none; }
	.sep {
		margin-top: 2rem;
		margin-bottom: 1rem;
		margin-left:0;
		width: 24rem;
		border-top: 2px solid #ff8181; }
</style>

	</head>

<body>
<header class="container">
	<div class="u-header">
		<nav class="bar">
	<ul><li>
			<a href="/">
				<img class="icon-text" src="/img/prev.svg"/>
			</a>
		</li><li><a href="/about/">About</a></li><li><a href="/blog/">Blog</a></li></ul>
</nav>

	</div>
</header>
<main class="container">

<article>
	<header><hgroup id="brand">
	<h1>Wikireducer : Following Wikipedia links</h1>
	<h5>
		<time datetime="2018-01-31 00:00:00 &#43;0000 UTC">Jan 31, 2018</time>
		-
			
			<a href="/tags/blog">blog</a>
			
			<a href="/tags/project">project</a>
			</h5>
	
</hgroup>
<hr class="sep" />
</header>
	

<h2 id="overview">Overview</h2>

<p>I came back from the gym last week and a few of my friend&rsquo;s made the following
claim:</p>

<blockquote>
<p>Following the first link of a Wikipedia article always leads to philosophy.</p>
</blockquote>

<p>It was a very strong claim, but one that can be verified easily.</p>

<h2 id="solution">Solution</h2>

<p>My previous scraping projects and linksearchers have been exclusively in Python.
I love Python, but I have been exposed to Ruby over the past months and decided
this project would be a good fit. 5 months ago I made
<a href="https://github.com/dang3r/seguridad">Seguridad</a> to learn how to make a Ruby gem
and increase my exposure to the language. I was hoping to do the same this time.</p>

<h2 id="implementation">Implementation</h2>

<p>I implemented the solution using the Ruby standard library for making requests
and <a href="https://github.com/sparklemotion/nokogiri">Nokogiri</a> for parsing HTML.</p>

<p>I created a small library called <code>Wikio</code> containing a couple of functions that
would make solving the problem straightforward.</p>

<p>My first problem was:</p>

<blockquote>
<p>How do I retrieve the wikipedia page for a given term?</p>
</blockquote>

<p>Wikipedia provides a nice API for retrieving this information. You can view more
documentation at
<a href="https://www.mediawiki.org/wiki/API:Main_page#The_endpoint">MediaWiki</a>.</p>

<p>The second and more involved problem was:</p>

<blockquote>
<p>How do I retrieve the first link on a given Wikipedia article?</p>
</blockquote>

<p>First, I had to find the corresponding HTML for a page.</p>

<p><img src="/img/wiki-dog.png" alt="Doggo" /></p>

<p>The above image represents the HTML for the main body of the Wikipedia article.</p>

<p><img src="/img/wiki-html.png" alt="CloserLook" /></p>

<p>At a closer look, at <code>p</code> elements underneath the <code>div.mw-parser-output</code> element
contain the content of the article. Specifically, all anchors either directly
under those <code>p</code> elements, or underneath a <code>p</code> then an <code>i</code> contained article
links. This can be converted to an <code>xpath</code> expression for use by Nokogiri.</p>

<p><img src="/img/wiki-italics.png" alt="Italics" /></p>

<h2 id="wikio-wikireducer">Wikio, Wikireducer</h2>

<p>Wikireducer is a script that performs the search solving the problem. Wikio is
the helper library powering it. The code can be found
<a href="https://github.com/dang3r/wikio">here</a>!</p>

<p>An example of using <code>Wikireducer</code> is below:</p>

<pre><code># Finding the number of steps
$ gem install wikio
$ wikireducer --dst=Knowledge Cat Dog
Searching for https://en.wikipedia.org/wiki/Knowledge
$ wikireducer --dst=Knowledge Cat Dog
Searching for https://en.wikipedia.org/wiki/Knowledge
https://en.wikipedia.org/wiki/Dog -&gt; https://en.wikipedia.org/wiki/Dog
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Cat
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Fur
https://en.wikipedia.org/wiki/Dog -&gt; https://en.wikipedia.org/wiki/Canis
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Hair
https://en.wikipedia.org/wiki/Dog -&gt; https://en.wikipedia.org/wiki/Genus
...
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Knowledge in 14 steps
https://en.wikipedia.org/wiki/Dog -&gt; https://en.wikipedia.org/wiki/Knowledge in 14 steps
</code></pre>

<p>Sometimes, cycles are detected when performing a search</p>

<pre><code># Identifying Cycles
$ gem install wikio
$ wikireducer --dst=Philosophy Dog Cat
Searching for https://en.wikipedia.org/wiki/Philosophy
https://en.wikipedia.org/wiki/Dog -&gt; https://en.wikipedia.org/wiki/Dog
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Cat
https://en.wikipedia.org/wiki/Dog -&gt; https://en.wikipedia.org/wiki/Canis
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Fur
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Hair
https://en.wikipedia.org/wiki/Dog -&gt; https://en.wikipedia.org/wiki/Genus
....
Cycle detected for https://en.wikipedia.org/wiki/Dog at node
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Ancient_Greek_language
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Greek_language
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Modern_Greek
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Colloquialism
https://en.wikipedia.org/wiki/Cat -&gt; https://en.wikipedia.org/wiki/Vernacular
Cycle detected for https://en.wikipedia.org/wiki/Cat at node
</code></pre>

<p>You can install Wikio+Wikireducer via <code>gem install wikio</code>.</p>

<h2 id="conclusion">Conclusion</h2>

<p>This was a fun experiment to delve into Ruby with.</p>

<p>Writing this post also made me realize I wish I could caption images in
markdown. There is probably a way using raw HTML+CSS, but I will leave that for
a future post.</p>

<h2 id="resources">Resources</h2>

<ul>
<li><a href="http://guides.rubygems.org/make-your-own-gem/">http://guides.rubygems.org/make-your-own-gem/</a></li>
<li><a href="https://stackoverflow.com/questions/27457977/searching-wikipedia-using-api">https://stackoverflow.com/questions/27457977/searching-wikipedia-using-api</a></li>
</ul>

	<nav>
	
		<a class="prev-post" href="http://danielcardoza.com/blog/jenophone/">
			<img class="icon-text" src="/img/prev.svg"/>Jenophone : SMS forwarder using Twilio</a>
	
	
	</nav>
</article>

			<hr class="sep" />
		</main>
		<footer class="container">
			<div class="u-footer">
				

<a href="https://github.com/dang3r"><img class="icon-social" src="/img/github.svg" alt="Github"/></a>


<a href="http://danielcardoza.com/index.xml" target="_blank"><img class="icon-social" src="/img/feed.svg" alt="Feed"></a>

				<p>
					
					
					&copy; 2017 Daniel Cardoza
					
					
				</p>
				
				<a href="#">
					<img class="icon-text" src="/img/toup.svg" alt="To Up"/>
					<span>Back to Up</span>
				</a>
				
			</div>
		</footer>
		
	</body>
</html>

